{"diffoscope-json-version": 1, "source1": "first/FileSystemUtils.class", "source2": "second/FileSystemUtils.class", "unified_diff": null, "details": [{"source1": "procyon -ec {}", "source2": "procyon -ec {}", "unified_diff": "@@ -1,36 +1,70 @@\n \n package org.apache.commons.io;\n \n import java.io.OutputStream;\n import java.io.InputStream;\n import java.util.Arrays;\n-import java.util.Locale;\n import java.io.Reader;\n import java.io.BufferedReader;\n import java.io.InputStreamReader;\n import java.nio.charset.Charset;\n import java.util.ArrayList;\n import java.util.StringTokenizer;\n import java.util.List;\n import java.io.File;\n+import java.util.Locale;\n import java.io.IOException;\n \n @Deprecated\n public class FileSystemUtils\n {\n     private static final FileSystemUtils INSTANCE;\n     private static final int INIT_PROBLEM = -1;\n     private static final int OTHER = 0;\n     private static final int WINDOWS = 1;\n     private static final int UNIX = 2;\n     private static final int POSIX_UNIX = 3;\n     private static final int OS;\n     private static final String DF;\n     \n+    static {\n+        INSTANCE = new FileSystemUtils();\n+        int os = 0;\n+        String dfPath = \"df\";\n+        try {\n+            String osName = System.getProperty(\"os.name\");\n+            if (osName == null) {\n+                throw new IOException(\"os.name not found\");\n+            }\n+            osName = osName.toLowerCase(Locale.ENGLISH);\n+            if (osName.contains(\"windows\")) {\n+                os = 1;\n+            }\n+            else if (osName.contains(\"linux\") || osName.contains(\"mpe/ix\") || osName.contains(\"freebsd\") || osName.contains(\"openbsd\") || osName.contains(\"irix\") || osName.contains(\"digital unix\") || osName.contains(\"unix\") || osName.contains(\"mac os x\")) {\n+                os = 2;\n+            }\n+            else if (osName.contains(\"sun os\") || osName.contains(\"sunos\") || osName.contains(\"solaris\")) {\n+                os = 3;\n+                dfPath = \"/usr/xpg4/bin/df\";\n+            }\n+            else if (osName.contains(\"hp-ux\") || osName.contains(\"aix\")) {\n+                os = 3;\n+            }\n+            else {\n+                os = 0;\n+            }\n+        }\n+        catch (final Exception ex) {\n+            os = -1;\n+        }\n+        OS = os;\n+        DF = dfPath;\n+    }\n+    \n     @Deprecated\n     public static long freeSpace(final String path) throws IOException {\n         return FileSystemUtils.INSTANCE.freeSpaceOS(path, FileSystemUtils.OS, false, -1L);\n     }\n     \n     @Deprecated\n     public static long freeSpaceKb(final String path) throws IOException {\n@@ -93,63 +127,68 @@\n         }\n         throw new IOException(\"Command line 'dir /-c' did not return any info for path '\" + normPath + \"'\");\n     }\n     \n     long parseDir(final String line, final String path) throws IOException {\n         int bytesStart = 0;\n         int bytesEnd = 0;\n-        int j;\n-        for (j = line.length() - 1; j >= 0; --j) {\n-            final char c = line.charAt(j);\n-            if (Character.isDigit(c)) {\n-                bytesEnd = j + 1;\n-                break;\n-            }\n-        }\n-        while (j >= 0) {\n-            final char c = line.charAt(j);\n-            if (!Character.isDigit(c) && c != ',' && c != '.') {\n-                bytesStart = j + 1;\n-                break;\n+        int j = line.length() - 1;\n+        while (true) {\n+            while (j >= 0) {\n+                char c = line.charAt(j);\n+                if (Character.isDigit(c)) {\n+                    bytesEnd = j + 1;\n+                    while (j >= 0) {\n+                        c = line.charAt(j);\n+                        if (!Character.isDigit(c) && c != ',' && c != '.') {\n+                            bytesStart = j + 1;\n+                            break;\n+                        }\n+                        --j;\n+                    }\n+                    if (j < 0) {\n+                        throw new IOException(\"Command line 'dir /-c' did not return valid info for path '\" + path + \"'\");\n+                    }\n+                    final StringBuilder buf = new StringBuilder(line.substring(bytesStart, bytesEnd));\n+                    for (int k = 0; k < buf.length(); ++k) {\n+                        if (buf.charAt() == ',' || buf.charAt() == '.') {\n+                            buf.deleteCharAt(k--);\n+                        }\n+                    }\n+                    return this.parseBytes(buf.toString(), path);\n+                }\n+                else {\n+                    --j;\n+                }\n             }\n-            --j;\n+            continue;\n         }\n-        if (j < 0) {\n-            throw new IOException(\"Command line 'dir /-c' did not return valid info for path '\" + path + \"'\");\n-        }\n-        final StringBuilder buf = new StringBuilder(line.substring(bytesStart, bytesEnd));\n-        for (int k = 0; k < buf.length(); ++k) {\n-            if (buf.charAt() == ',' || buf.charAt() == '.') {\n-                buf.deleteCharAt(k--);\n-            }\n-        }\n-        return this.parseBytes(buf.toString(), path);\n     }\n     \n     long freeSpaceUnix(final String path, final boolean kb, final boolean posix, final long timeout) throws IOException {\n         if (path.isEmpty()) {\n             throw new IllegalArgumentException(\"Path must not be empty\");\n         }\n         String flags = \"-\";\n         if (kb) {\n-            flags += \"k\";\n+            flags = String.valueOf(flags) + \"k\";\n         }\n         if (posix) {\n-            flags += \"P\";\n+            flags = String.valueOf(flags) + \"P\";\n         }\n         final String[] cmdAttribs = (flags.length() > 1) ? new String[] { FileSystemUtils.DF, flags, path } : new String[] { FileSystemUtils.DF, path };\n         final List<String> lines = this.performCommand(cmdAttribs, 3, timeout);\n         if (lines.size() < 2) {\n-            throw new IOException(\"Command line '\" + FileSystemUtils.DF + \"' did not return info as expected for path '\" + path + \"'- response was \" + lines);\n+            throw new IOException(\"Command line '\" + FileSystemUtils.DF + \"' did not return info as expected \" + \"for path '\" + path + \"'- response was \" + lines);\n         }\n         final String line2 = (String)lines.get(1);\n         StringTokenizer tok = new StringTokenizer(line2, \" \");\n         if (tok.countTokens() < 4) {\n             if (tok.countTokens() != 1 || lines.size() < 3) {\n-                throw new IOException(\"Command line '\" + FileSystemUtils.DF + \"' did not return data as expected for path '\" + path + \"'- check path is valid\");\n+                throw new IOException(\"Command line '\" + FileSystemUtils.DF + \"' did not return data as expected \" + \"for path '\" + path + \"'- check path is valid\");\n             }\n             final String line3 = (String)lines.get(2);\n             tok = new StringTokenizer(line3, \" \");\n         }\n         else {\n             tok.nextToken();\n         }\n@@ -159,20 +198,20 @@\n         return this.parseBytes(freeSpace, path);\n     }\n     \n     long parseBytes(final String freeSpace, final String path) throws IOException {\n         try {\n             final long bytes = Long.parseLong(freeSpace);\n             if (bytes < 0L) {\n-                throw new IOException(\"Command line '\" + FileSystemUtils.DF + \"' did not find free space in response for path '\" + path + \"'- check path is valid\");\n+                throw new IOException(\"Command line '\" + FileSystemUtils.DF + \"' did not find free space in response \" + \"for path '\" + path + \"'- check path is valid\");\n             }\n             return bytes;\n         }\n         catch (final NumberFormatException ex) {\n-            throw new IOException(\"Command line '\" + FileSystemUtils.DF + \"' did not return numeric data as expected for path '\" + path + \"'- check path is valid\", ex);\n+            throw new IOException(\"Command line '\" + FileSystemUtils.DF + \"' did not return numeric data as expected \" + \"for path '\" + path + \"'- check path is valid\", ex);\n         }\n     }\n     \n     List<String> performCommand(final String[] cmdAttribs, final int max, final long timeout) throws IOException {\n         final List<String> lines = new ArrayList<String>(20);\n         Process proc = null;\n         InputStream in = null;\n@@ -225,42 +264,8 @@\n             }\n         }\n     }\n     \n     Process openProcess(final String[] cmdAttribs) throws IOException {\n         return Runtime.getRuntime().exec(cmdAttribs);\n     }\n-    \n-    static {\n-        INSTANCE = new FileSystemUtils();\n-        int os = 0;\n-        String dfPath = \"df\";\n-        try {\n-            String osName = System.getProperty(\"os.name\");\n-            if (osName == null) {\n-                throw new IOException(\"os.name not found\");\n-            }\n-            osName = osName.toLowerCase(Locale.ENGLISH);\n-            if (osName.contains(\"windows\")) {\n-                os = 1;\n-            }\n-            else if (osName.contains(\"linux\") || osName.contains(\"mpe/ix\") || osName.contains(\"freebsd\") || osName.contains(\"openbsd\") || osName.contains(\"irix\") || osName.contains(\"digital unix\") || osName.contains(\"unix\") || osName.contains(\"mac os x\")) {\n-                os = 2;\n-            }\n-            else if (osName.contains(\"sun os\") || osName.contains(\"sunos\") || osName.contains(\"solaris\")) {\n-                os = 3;\n-                dfPath = \"/usr/xpg4/bin/df\";\n-            }\n-            else if (osName.contains(\"hp-ux\") || osName.contains(\"aix\")) {\n-                os = 3;\n-            }\n-            else {\n-                os = 0;\n-            }\n-        }\n-        catch (final Exception ex) {\n-            os = -1;\n-        }\n-        OS = os;\n-        DF = dfPath;\n-    }\n }\n"}]}
