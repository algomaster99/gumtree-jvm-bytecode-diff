{"diffoscope-json-version": 1, "source1": "first/PathUtils.class", "source2": "second/PathUtils.class", "unified_diff": null, "details": [{"source1": "procyon -ec {}", "source2": "procyon -ec {}", "unified_diff": "@@ -48,14 +48,24 @@\n     public static final DeleteOption[] EMPTY_DELETE_OPTION_ARRAY;\n     public static final FileVisitOption[] EMPTY_FILE_VISIT_OPTION_ARRAY;\n     public static final LinkOption[] EMPTY_LINK_OPTION_ARRAY;\n     public static final LinkOption[] NOFOLLOW_LINK_OPTION_ARRAY;\n     public static final OpenOption[] EMPTY_OPEN_OPTION_ARRAY;\n     public static final Path[] EMPTY_PATH_ARRAY;\n     \n+    static {\n+        EMPTY_COPY_OPTIONS = new CopyOption[0];\n+        EMPTY_DELETE_OPTION_ARRAY = new DeleteOption[0];\n+        EMPTY_FILE_VISIT_OPTION_ARRAY = new FileVisitOption[0];\n+        EMPTY_LINK_OPTION_ARRAY = new LinkOption[0];\n+        NOFOLLOW_LINK_OPTION_ARRAY = new LinkOption[] { LinkOption.NOFOLLOW_LINKS };\n+        EMPTY_OPEN_OPTION_ARRAY = new OpenOption[0];\n+        EMPTY_PATH_ARRAY = new Path[0];\n+    }\n+    \n     private static AccumulatorPathVisitor accumulate(final Path directory, final int maxDepth, final FileVisitOption[] fileVisitOptions) throws IOException {\n         return visitFileTree(AccumulatorPathVisitor.withLongCounters(), directory, toFileVisitOptionSet(fileVisitOptions), maxDepth);\n     }\n     \n     public static Counters.PathCounters cleanDirectory(final Path directory) throws IOException {\n         return cleanDirectory(directory, PathUtils.EMPTY_DELETE_OPTION_ARRAY);\n     }\n@@ -66,28 +76,70 @@\n     \n     public static Counters.PathCounters copyDirectory(final Path sourceDirectory, final Path targetDirectory, final CopyOption... copyOptions) throws IOException {\n         final Path absoluteSource = sourceDirectory.toAbsolutePath();\n         return ((CopyDirectoryVisitor)visitFileTree(new CopyDirectoryVisitor(Counters.longPathCounters(), absoluteSource, targetDirectory, copyOptions), absoluteSource)).getPathCounters();\n     }\n     \n     public static Path copyFile(final URL sourceFile, final Path targetFile, final CopyOption... copyOptions) throws IOException {\n-        try (final InputStream inputStream = sourceFile.openStream()) {\n-            Files.copy(inputStream, targetFile, copyOptions);\n-            return targetFile;\n+        Throwable t = null;\n+        try {\n+            final InputStream inputStream = sourceFile.openStream();\n+            try {\n+                Files.copy(inputStream, targetFile, copyOptions);\n+                return targetFile;\n+            }\n+            finally {\n+                if (inputStream != null) {\n+                    inputStream.close();\n+                }\n+            }\n+        }\n+        finally {\n+            if (t == null) {\n+                final Throwable exception;\n+                t = exception;\n+            }\n+            else {\n+                final Throwable exception;\n+                if (t != exception) {\n+                    t.addSuppressed(exception);\n+                }\n+            }\n         }\n     }\n     \n     public static Path copyFileToDirectory(final Path sourceFile, final Path targetDirectory, final CopyOption... copyOptions) throws IOException {\n         return Files.copy(sourceFile, targetDirectory.resolve(sourceFile.getFileName()), copyOptions);\n     }\n     \n     public static Path copyFileToDirectory(final URL sourceFile, final Path targetDirectory, final CopyOption... copyOptions) throws IOException {\n-        try (final InputStream inputStream = sourceFile.openStream()) {\n-            Files.copy(inputStream, targetDirectory.resolve(sourceFile.getFile()), copyOptions);\n-            return targetDirectory;\n+        Throwable t = null;\n+        try {\n+            final InputStream inputStream = sourceFile.openStream();\n+            try {\n+                Files.copy(inputStream, targetDirectory.resolve(sourceFile.getFile()), copyOptions);\n+                return targetDirectory;\n+            }\n+            finally {\n+                if (inputStream != null) {\n+                    inputStream.close();\n+                }\n+            }\n+        }\n+        finally {\n+            if (t == null) {\n+                final Throwable exception;\n+                t = exception;\n+            }\n+            else {\n+                final Throwable exception;\n+                if (t != exception) {\n+                    t.addSuppressed(exception);\n+                }\n+            }\n         }\n     }\n     \n     public static Counters.PathCounters countDirectory(final Path directory) throws IOException {\n         return ((CountingPathVisitor)visitFileTree(new CountingPathVisitor(Counters.longPathCounters()), directory)).getPathCounters();\n     }\n     \n@@ -162,15 +214,15 @@\n         }\n         if (path1 == null || path2 == null) {\n             return false;\n         }\n         if (Files.notExists(path1, new LinkOption[0]) && Files.notExists(path2, new LinkOption[0])) {\n             return true;\n         }\n-        final PathUtils.RelativeSortedPaths relativeSortedPaths = new PathUtils.RelativeSortedPaths(path1, path2, Integer.MAX_VALUE, linkOptions, fileVisitOption, (PathUtils.PathUtils$1)null);\n+        final PathUtils.RelativeSortedPaths relativeSortedPaths = new PathUtils.RelativeSortedPaths(path1, path2, Integer.MAX_VALUE, linkOptions, fileVisitOption, (PathUtils.RelativeSortedPaths)null);\n         if (!relativeSortedPaths.equals) {\n             return false;\n         }\n         final List<Path> fileList1 = relativeSortedPaths.relativeFileList1;\n         final List<Path> fileList2 = relativeSortedPaths.relativeFileList2;\n         for (final Path path3 : fileList1) {\n             final int binarySearch = Collections.binarySearch(fileList2, path3);\n@@ -185,15 +237,15 @@\n     }\n     \n     public static boolean directoryContentEquals(final Path path1, final Path path2) throws IOException {\n         return directoryContentEquals(path1, path2, Integer.MAX_VALUE, PathUtils.EMPTY_LINK_OPTION_ARRAY, PathUtils.EMPTY_FILE_VISIT_OPTION_ARRAY);\n     }\n     \n     public static boolean directoryContentEquals(final Path path1, final Path path2, final int maxDepth, final LinkOption[] linkOptions, final FileVisitOption[] fileVisitOptions) throws IOException {\n-        return new PathUtils.RelativeSortedPaths(path1, path2, maxDepth, linkOptions, fileVisitOptions, (PathUtils.PathUtils$1)null).equals;\n+        return new PathUtils.RelativeSortedPaths(path1, path2, maxDepth, linkOptions, fileVisitOptions, (PathUtils.RelativeSortedPaths)null).equals;\n     }\n     \n     public static boolean fileContentEquals(final Path path1, final Path path2) throws IOException {\n         return fileContentEquals(path1, path2, PathUtils.EMPTY_LINK_OPTION_ARRAY, PathUtils.EMPTY_OPEN_OPTION_ARRAY);\n     }\n     \n     public static boolean fileContentEquals(final Path path1, final Path path2, final LinkOption[] linkOptions, final OpenOption[] openOptions) throws IOException {\n@@ -220,17 +272,59 @@\n         }\n         if (Files.size(nPath1) != Files.size(nPath2)) {\n             return false;\n         }\n         if (path1.equals(path2)) {\n             return true;\n         }\n-        try (final InputStream inputStream1 = Files.newInputStream(nPath1, openOptions);\n-             final InputStream inputStream2 = Files.newInputStream(nPath2, openOptions)) {\n-            return IOUtils.contentEquals(inputStream1, inputStream2);\n+        Throwable t = null;\n+        try {\n+            final InputStream inputStream1 = Files.newInputStream(nPath1, openOptions);\n+            try {\n+                final InputStream inputStream2 = Files.newInputStream(nPath2, openOptions);\n+                try {\n+                    final boolean contentEquals = IOUtils.contentEquals(inputStream1, inputStream2);\n+                    if (inputStream2 != null) {\n+                        inputStream2.close();\n+                    }\n+                    return contentEquals;\n+                }\n+                finally {\n+                    if (inputStream2 != null) {\n+                        inputStream2.close();\n+                    }\n+                }\n+            }\n+            finally {\n+                if (t == null) {\n+                    final Throwable exception;\n+                    t = exception;\n+                }\n+                else {\n+                    final Throwable exception;\n+                    if (t != exception) {\n+                        t.addSuppressed(exception);\n+                    }\n+                }\n+                if (inputStream1 != null) {\n+                    inputStream1.close();\n+                }\n+            }\n+        }\n+        finally {\n+            if (t == null) {\n+                final Throwable exception2;\n+                t = exception2;\n+            }\n+            else {\n+                final Throwable exception2;\n+                if (t != exception2) {\n+                    t.addSuppressed(exception2);\n+                }\n+            }\n         }\n     }\n     \n     public static Path[] filter(final PathFilter filter, final Path... paths) {\n         Objects.requireNonNull(filter, \"filter\");\n         if (paths == null) {\n             return PathUtils.EMPTY_PATH_ARRAY;\n@@ -242,17 +336,17 @@\n         Objects.requireNonNull(filter, \"filter\");\n         Objects.requireNonNull(collector, \"collector\");\n         if (stream == null) {\n             return Stream.empty().collect((Collector<? super Object, A, R>)collector);\n         }\n         return stream.filter(p -> {\n             try {\n-                return p != null && filter.accept(p, readBasicFileAttributes(p)) == FileVisitResult.CONTINUE;\n+                return p != null && pathFilter.accept(p, readBasicFileAttributes(p)) == FileVisitResult.CONTINUE;\n             }\n-            catch (final IOException e) {\n+            catch (final IOException ex) {\n                 return false;\n             }\n         }).collect(collector);\n     }\n     \n     public static List<AclEntry> getAclEntryList(final Path sourcePath) throws IOException {\n         final AclFileAttributeView fileAttributeView = (AclFileAttributeView)Files.getFileAttributeView(sourcePath, AclFileAttributeView.class, new LinkOption[0]);\n@@ -264,16 +358,37 @@\n     }\n     \n     public static boolean isEmpty(final Path path) throws IOException {\n         return Files.isDirectory(path, new LinkOption[0]) ? isEmptyDirectory(path) : isEmptyFile(path);\n     }\n     \n     public static boolean isEmptyDirectory(final Path directory) throws IOException {\n-        try (final DirectoryStream<Path> directoryStream = Files.newDirectoryStream(directory)) {\n-            return !directoryStream.iterator().hasNext();\n+        Throwable t = null;\n+        try {\n+            final DirectoryStream<Path> directoryStream = Files.newDirectoryStream(directory);\n+            try {\n+                return !directoryStream.iterator().hasNext();\n+            }\n+            finally {\n+                if (directoryStream != null) {\n+                    directoryStream.close();\n+                }\n+            }\n+        }\n+        finally {\n+            if (t == null) {\n+                final Throwable exception;\n+                t = exception;\n+            }\n+            else {\n+                final Throwable exception;\n+                if (t != exception) {\n+                    t.addSuppressed(exception);\n+                }\n+            }\n         }\n     }\n     \n     public static boolean isEmptyFile(final Path file) throws IOException {\n         return Files.size(file) <= 0L;\n     }\n     \n@@ -366,23 +481,13 @@\n     }\n     \n     public static <T extends FileVisitor<? super Path>> T visitFileTree(final T visitor, final URI uri) throws IOException {\n         return visitFileTree(visitor, Paths.get(uri));\n     }\n     \n     public static Stream<Path> walk(final Path start, final PathFilter pathFilter, final int maxDepth, final boolean readAttributes, final FileVisitOption... options) throws IOException {\n-        return Files.walk(start, maxDepth, options).filter(path -> pathFilter.accept(path, readAttributes ? readBasicFileAttributesUnchecked(path) : null) == FileVisitResult.CONTINUE);\n+        return Files.walk(start, maxDepth, options).filter(path -> pathFilter2.accept(path, b ? readBasicFileAttributesUnchecked(path) : null) == FileVisitResult.CONTINUE);\n     }\n     \n     private PathUtils() {\n     }\n-    \n-    static {\n-        EMPTY_COPY_OPTIONS = new CopyOption[0];\n-        EMPTY_DELETE_OPTION_ARRAY = new DeleteOption[0];\n-        EMPTY_FILE_VISIT_OPTION_ARRAY = new FileVisitOption[0];\n-        EMPTY_LINK_OPTION_ARRAY = new LinkOption[0];\n-        NOFOLLOW_LINK_OPTION_ARRAY = new LinkOption[] { LinkOption.NOFOLLOW_LINKS };\n-        EMPTY_OPEN_OPTION_ARRAY = new OpenOption[0];\n-        EMPTY_PATH_ARRAY = new Path[0];\n-    }\n }\n"}]}
