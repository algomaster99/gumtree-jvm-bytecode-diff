{"diffoscope-json-version": 1, "source1": "first/Lister.class", "source2": "second/Lister.class", "unified_diff": null, "details": [{"source1": "procyon -ec {}", "source2": "procyon -ec {}", "unified_diff": "@@ -12,14 +12,18 @@\n import java.nio.file.OpenOption;\n import java.io.File;\n \n public final class Lister\n {\n     private static final ArchiveStreamFactory factory;\n     \n+    static {\n+        factory = new ArchiveStreamFactory();\n+    }\n+    \n     public static void main(final String[] args) throws Exception {\n         if (args.length == 0) {\n             usage();\n             return;\n         }\n         System.out.println(\"Analysing \" + args[0]);\n         final File f = new File(args[0]);\n@@ -35,61 +39,160 @@\n         }\n         else {\n             listStream(f, args);\n         }\n     }\n     \n     private static void listStream(final File f, final String[] args) throws ArchiveException, IOException {\n-        try (final InputStream fis = new BufferedInputStream(Files.newInputStream(f.toPath(), new OpenOption[0]));\n-             final ArchiveInputStream ais = createArchiveInputStream(args, fis)) {\n-            System.out.println(\"Created \" + ais.toString());\n-            ArchiveEntry ae;\n-            while ((ae = ais.getNextEntry()) != null) {\n-                System.out.println(ae.getName());\n+        Throwable t = null;\n+        try {\n+            final InputStream fis = new BufferedInputStream(Files.newInputStream(f.toPath(), new OpenOption[0]));\n+            try {\n+                final ArchiveInputStream ais = createArchiveInputStream(args, fis);\n+                try {\n+                    System.out.println(\"Created \" + ais.toString());\n+                    ArchiveEntry ae;\n+                    while ((ae = ais.getNextEntry()) != null) {\n+                        System.out.println(ae.getName());\n+                    }\n+                }\n+                finally {\n+                    if (ais != null) {\n+                        ais.close();\n+                    }\n+                }\n+                if (fis != null) {\n+                    fis.close();\n+                }\n+            }\n+            finally {\n+                if (t == null) {\n+                    final Throwable exception;\n+                    t = exception;\n+                }\n+                else {\n+                    final Throwable exception;\n+                    if (t != exception) {\n+                        t.addSuppressed(exception);\n+                    }\n+                }\n+                if (fis != null) {\n+                    fis.close();\n+                }\n+            }\n+        }\n+        finally {\n+            if (t == null) {\n+                final Throwable exception2;\n+                t = exception2;\n+            }\n+            else {\n+                final Throwable exception2;\n+                if (t != exception2) {\n+                    t.addSuppressed(exception2);\n+                }\n             }\n         }\n     }\n     \n     private static ArchiveInputStream createArchiveInputStream(final String[] args, final InputStream fis) throws ArchiveException {\n         if (args.length > 1) {\n             return Lister.factory.createArchiveInputStream(args[1], fis);\n         }\n         return Lister.factory.createArchiveInputStream(fis);\n     }\n     \n     private static String detectFormat(final File f) throws ArchiveException, IOException {\n-        try (final InputStream fis = new BufferedInputStream(Files.newInputStream(f.toPath(), new OpenOption[0]))) {\n-            final ArchiveStreamFactory factory = Lister.factory;\n-            return ArchiveStreamFactory.detect(fis);\n+        Throwable t = null;\n+        try {\n+            final InputStream fis = new BufferedInputStream(Files.newInputStream(f.toPath(), new OpenOption[0]));\n+            try {\n+                return ArchiveStreamFactory.detect(fis);\n+            }\n+            finally {\n+                if (fis != null) {\n+                    fis.close();\n+                }\n+            }\n+        }\n+        finally {\n+            if (t == null) {\n+                final Throwable exception;\n+                t = exception;\n+            }\n+            else {\n+                final Throwable exception;\n+                if (t != exception) {\n+                    t.addSuppressed(exception);\n+                }\n+            }\n         }\n     }\n     \n     private static void list7z(final File f) throws ArchiveException, IOException {\n-        try (final SevenZFile z = new SevenZFile(f)) {\n-            System.out.println(\"Created \" + z.toString());\n-            ArchiveEntry ae;\n-            while ((ae = (ArchiveEntry)z.getNextEntry()) != null) {\n-                final String name = (ae.getName() == null) ? (z.getDefaultName() + \" (entry name was null)\") : ae.getName();\n-                System.out.println(name);\n+        Throwable t = null;\n+        try {\n+            final SevenZFile z = new SevenZFile(f);\n+            try {\n+                System.out.println(\"Created \" + z.toString());\n+                ArchiveEntry ae;\n+                while ((ae = (ArchiveEntry)z.getNextEntry()) != null) {\n+                    final String name = (ae.getName() == null) ? (String.valueOf(z.getDefaultName()) + \" (entry name was null)\") : ae.getName();\n+                    System.out.println(name);\n+                }\n+            }\n+            finally {\n+                if (z != null) {\n+                    z.close();\n+                }\n+            }\n+        }\n+        finally {\n+            if (t == null) {\n+                final Throwable exception;\n+                t = exception;\n+            }\n+            else {\n+                final Throwable exception;\n+                if (t != exception) {\n+                    t.addSuppressed(exception);\n+                }\n             }\n         }\n     }\n     \n     private static void listZipUsingZipFile(final File f) throws ArchiveException, IOException {\n-        try (final ZipFile z = new ZipFile(f)) {\n-            System.out.println(\"Created \" + z.toString());\n-            final Enumeration<ZipArchiveEntry> en = z.getEntries();\n-            while (en.hasMoreElements()) {\n-                System.out.println(((ZipArchiveEntry)en.nextElement()).getName());\n+        Throwable t = null;\n+        try {\n+            final ZipFile z = new ZipFile(f);\n+            try {\n+                System.out.println(\"Created \" + z.toString());\n+                final Enumeration<ZipArchiveEntry> en = z.getEntries();\n+                while (en.hasMoreElements()) {\n+                    System.out.println(((ZipArchiveEntry)en.nextElement()).getName());\n+                }\n+            }\n+            finally {\n+                if (z != null) {\n+                    z.close();\n+                }\n+            }\n+        }\n+        finally {\n+            if (t == null) {\n+                final Throwable exception;\n+                t = exception;\n+            }\n+            else {\n+                final Throwable exception;\n+                if (t != exception) {\n+                    t.addSuppressed(exception);\n+                }\n             }\n         }\n     }\n     \n     private static void usage() {\n         System.out.println(\"Parameters: archive-name [archive-type]\\n\");\n         System.out.println(\"the magic archive-type 'zipfile' prefers ZipFile over ZipArchiveInputStream\");\n     }\n-    \n-    static {\n-        factory = new ArchiveStreamFactory();\n-    }\n }\n"}]}
