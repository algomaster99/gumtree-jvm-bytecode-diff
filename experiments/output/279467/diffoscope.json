{"diffoscope-json-version": 1, "source1": "first/NewAttributeBands.class", "source2": "second/NewAttributeBands.class", "unified_diff": null, "details": [{"source1": "procyon -ec {}", "source2": "procyon -ec {}", "unified_diff": "@@ -26,330 +26,326 @@\n         attributeLayout.setBackwardsCallCount(this.backwardsCallCount);\n     }\n     \n     public int getBackwardsCallCount() {\n         return this.backwardsCallCount;\n     }\n     \n-    public BHSDCodec getCodec(final String layoutElement) {\n-        if (layoutElement.indexOf(79) >= 0) {\n+    public BHSDCodec getCodec(final String s) {\n+        if (s.indexOf(79) >= 0) {\n             return Codec.BRANCH5;\n         }\n-        if (layoutElement.indexOf(80) >= 0) {\n+        if (s.indexOf(80) >= 0) {\n             return Codec.BCI5;\n         }\n-        if (layoutElement.indexOf(83) >= 0 && layoutElement.indexOf(\"KS\") < 0 && layoutElement.indexOf(\"RS\") < 0) {\n+        if (s.indexOf(83) >= 0 && s.indexOf(\"KS\") < 0 && s.indexOf(\"RS\") < 0) {\n             return Codec.SIGNED5;\n         }\n-        if (layoutElement.indexOf(66) >= 0) {\n+        if (s.indexOf(66) >= 0) {\n             return Codec.BYTE1;\n         }\n         return Codec.UNSIGNED5;\n     }\n     \n-    private Attribute getOneAttribute(final int index, final List<NewAttributeBands.AttributeLayoutElement> elements) {\n-        final NewAttribute attribute = new NewAttribute(this.segment.getCpBands().cpUTF8Value(this.attributeLayout.getName()), this.attributeLayout.getIndex());\n-        for (final NewAttributeBands.AttributeLayoutElement element : elements) {\n-            element.addToAttribute(index, attribute);\n+    private Attribute getOneAttribute(final int n, final List<NewAttributeBands.AttributeLayoutElement> list) {\n+        final NewAttribute newAttribute = new NewAttribute(this.segment.getCpBands().cpUTF8Value(this.attributeLayout.getName()), this.attributeLayout.getIndex());\n+        final Iterator<NewAttributeBands.AttributeLayoutElement> iterator = list.iterator();\n+        while (iterator.hasNext()) {\n+            ((NewAttributeBands.AttributeLayoutElement)iterator.next()).addToAttribute(n, newAttribute);\n         }\n-        return (Attribute)attribute;\n+        return (Attribute)newAttribute;\n     }\n     \n-    private StringReader getStreamUpToMatchingBracket(final StringReader stream) throws IOException {\n+    private StringReader getStreamUpToMatchingBracket(final StringReader stringReader) throws IOException {\n         final StringBuilder sb = new StringBuilder();\n-        int foundBracket = -1;\n-        while (foundBracket != 0) {\n-            final int read = stream.read();\n+        int i = -1;\n+        while (i != 0) {\n+            final int read = stringReader.read();\n             if (read == -1) {\n                 break;\n             }\n             final char c = (char)read;\n             if (c == ']') {\n-                ++foundBracket;\n+                ++i;\n             }\n             if (c == '[') {\n-                --foundBracket;\n+                --i;\n             }\n-            if (foundBracket == 0) {\n+            if (i == 0) {\n                 continue;\n             }\n             sb.append(c);\n         }\n         return new StringReader(sb.toString());\n     }\n     \n-    public List<Attribute> parseAttributes(final InputStream in, final int occurrenceCount) throws IOException, Pack200Exception {\n-        for (final NewAttributeBands.AttributeLayoutElement element : this.attributeLayoutElements) {\n-            element.readBands(in, occurrenceCount);\n-        }\n-        final List<Attribute> attributes = new ArrayList<Attribute>(occurrenceCount);\n-        for (int i = 0; i < occurrenceCount; ++i) {\n-            attributes.add(this.getOneAttribute(i, this.attributeLayoutElements));\n+    public List<Attribute> parseAttributes(final InputStream inputStream, final int initialCapacity) throws IOException, Pack200Exception {\n+        final Iterator<NewAttributeBands.AttributeLayoutElement> iterator = this.attributeLayoutElements.iterator();\n+        while (iterator.hasNext()) {\n+            ((NewAttributeBands.AttributeLayoutElement)iterator.next()).readBands(inputStream, initialCapacity);\n+        }\n+        final ArrayList list = new ArrayList(initialCapacity);\n+        for (int i = 0; i < initialCapacity; ++i) {\n+            list.add(this.getOneAttribute(i, this.attributeLayoutElements));\n         }\n-        return attributes;\n+        return list;\n     }\n     \n     private void parseLayout() throws IOException {\n         if (this.attributeLayoutElements == null) {\n             this.attributeLayoutElements = new ArrayList<NewAttributeBands.AttributeLayoutElement>();\n-            final StringReader stream = new StringReader(this.attributeLayout.getLayout());\n-            NewAttributeBands.AttributeLayoutElement e;\n-            while ((e = this.readNextAttributeElement(stream)) != null) {\n-                this.attributeLayoutElements.add(e);\n+            NewAttributeBands.AttributeLayoutElement nextAttributeElement;\n+            while ((nextAttributeElement = this.readNextAttributeElement(new StringReader(this.attributeLayout.getLayout()))) != null) {\n+                this.attributeLayoutElements.add(nextAttributeElement);\n             }\n             this.resolveCalls();\n         }\n     }\n     \n-    public void read(final InputStream in) throws IOException, Pack200Exception {\n+    public void read(final InputStream inputStream) throws IOException, Pack200Exception {\n     }\n     \n-    private List<NewAttributeBands.LayoutElement> readBody(final StringReader stream) throws IOException {\n-        final List<NewAttributeBands.LayoutElement> layoutElements = new ArrayList<NewAttributeBands.LayoutElement>();\n-        NewAttributeBands.LayoutElement e;\n-        while ((e = this.readNextLayoutElement(stream)) != null) {\n-            layoutElements.add(e);\n+    private List<NewAttributeBands.LayoutElement> readBody(final StringReader stringReader) throws IOException {\n+        final ArrayList list = new ArrayList();\n+        NewAttributeBands.LayoutElement nextLayoutElement;\n+        while ((nextLayoutElement = this.readNextLayoutElement(stringReader)) != null) {\n+            list.add(nextLayoutElement);\n         }\n-        return layoutElements;\n+        return list;\n     }\n     \n-    private NewAttributeBands.AttributeLayoutElement readNextAttributeElement(final StringReader stream) throws IOException {\n-        stream.mark(1);\n-        final int next = stream.read();\n-        if (next == -1) {\n+    private NewAttributeBands.AttributeLayoutElement readNextAttributeElement(final StringReader stringReader) throws IOException {\n+        stringReader.mark(1);\n+        final int read = stringReader.read();\n+        if (read == -1) {\n             return null;\n         }\n-        if (next == 91) {\n-            return (NewAttributeBands.AttributeLayoutElement)new NewAttributeBands.Callable((List)this.readBody(this.getStreamUpToMatchingBracket(stream)));\n+        if (read == 91) {\n+            return (NewAttributeBands.AttributeLayoutElement)new NewAttributeBands.Callable((List)this.readBody(this.getStreamUpToMatchingBracket(stringReader)));\n         }\n-        stream.reset();\n-        return (NewAttributeBands.AttributeLayoutElement)this.readNextLayoutElement(stream);\n+        stringReader.reset();\n+        return (NewAttributeBands.AttributeLayoutElement)this.readNextLayoutElement(stringReader);\n     }\n     \n-    private NewAttributeBands.LayoutElement readNextLayoutElement(final StringReader stream) throws IOException {\n-        final int nextChar = stream.read();\n-        if (nextChar == -1) {\n+    private NewAttributeBands.LayoutElement readNextLayoutElement(final StringReader stringReader) throws IOException {\n+        final int read = stringReader.read();\n+        if (read == -1) {\n             return null;\n         }\n-        switch (nextChar) {\n+        switch (read) {\n             case 66:\n             case 72:\n             case 73:\n             case 86: {\n-                return (NewAttributeBands.LayoutElement)new NewAttributeBands.Integral(this, new String(new char[] { (char)nextChar }));\n+                return (NewAttributeBands.LayoutElement)new NewAttributeBands.Integral(this, new String(new char[] { (char)read }));\n             }\n             case 70:\n             case 83: {\n-                return (NewAttributeBands.LayoutElement)new NewAttributeBands.Integral(this, new String(new char[] { (char)nextChar, (char)stream.read() }));\n+                return (NewAttributeBands.LayoutElement)new NewAttributeBands.Integral(this, new String(new char[] { (char)read, (char)stringReader.read() }));\n             }\n             case 80: {\n-                stream.mark(1);\n-                if (stream.read() != 79) {\n-                    stream.reset();\n-                    return (NewAttributeBands.LayoutElement)new NewAttributeBands.Integral(this, \"P\" + (char)stream.read());\n+                stringReader.mark(1);\n+                if (stringReader.read() != 79) {\n+                    stringReader.reset();\n+                    return (NewAttributeBands.LayoutElement)new NewAttributeBands.Integral(this, \"P\" + (char)stringReader.read());\n                 }\n-                return (NewAttributeBands.LayoutElement)new NewAttributeBands.Integral(this, \"PO\" + (char)stream.read());\n+                return (NewAttributeBands.LayoutElement)new NewAttributeBands.Integral(this, \"PO\" + (char)stringReader.read());\n             }\n             case 79: {\n-                stream.mark(1);\n-                if (stream.read() != 83) {\n-                    stream.reset();\n-                    return (NewAttributeBands.LayoutElement)new NewAttributeBands.Integral(this, \"O\" + (char)stream.read());\n+                stringReader.mark(1);\n+                if (stringReader.read() != 83) {\n+                    stringReader.reset();\n+                    return (NewAttributeBands.LayoutElement)new NewAttributeBands.Integral(this, \"O\" + (char)stringReader.read());\n                 }\n-                return (NewAttributeBands.LayoutElement)new NewAttributeBands.Integral(this, \"OS\" + (char)stream.read());\n+                return (NewAttributeBands.LayoutElement)new NewAttributeBands.Integral(this, \"OS\" + (char)stringReader.read());\n             }\n             case 78: {\n-                final char uintType = (char)stream.read();\n-                stream.read();\n-                final String str = this.readUpToMatchingBracket(stream);\n-                return (NewAttributeBands.LayoutElement)new NewAttributeBands.Replication(this, \"\" + uintType, str);\n+                final char c = (char)stringReader.read();\n+                stringReader.read();\n+                return (NewAttributeBands.LayoutElement)new NewAttributeBands.Replication(this, \"\" + c, this.readUpToMatchingBracket(stringReader));\n             }\n             case 84: {\n-                String intType = \"\" + (char)stream.read();\n-                if (intType.equals(\"S\")) {\n-                    intType += (char)stream.read();\n+                String str = \"\" + (char)stringReader.read();\n+                if (str.equals(\"S\")) {\n+                    str += (char)stringReader.read();\n                 }\n-                final List<NewAttributeBands.UnionCase> unionCases = new ArrayList<NewAttributeBands.UnionCase>();\n-                NewAttributeBands.UnionCase c;\n-                while ((c = this.readNextUnionCase(stream)) != null) {\n-                    unionCases.add(c);\n+                final ArrayList list = new ArrayList();\n+                NewAttributeBands.UnionCase nextUnionCase;\n+                while ((nextUnionCase = this.readNextUnionCase(stringReader)) != null) {\n+                    list.add(nextUnionCase);\n                 }\n-                stream.read();\n-                stream.read();\n-                stream.read();\n+                stringReader.read();\n+                stringReader.read();\n+                stringReader.read();\n                 List<NewAttributeBands.LayoutElement> body = null;\n-                stream.mark(1);\n-                final char next = (char)stream.read();\n-                if (next != ']') {\n-                    stream.reset();\n-                    body = this.readBody(this.getStreamUpToMatchingBracket(stream));\n+                stringReader.mark(1);\n+                if ((char)stringReader.read() != ']') {\n+                    stringReader.reset();\n+                    body = this.readBody(this.getStreamUpToMatchingBracket(stringReader));\n                 }\n-                return (NewAttributeBands.LayoutElement)new NewAttributeBands.Union(this, intType, (List)unionCases, (List)body);\n+                return (NewAttributeBands.LayoutElement)new NewAttributeBands.Union(this, str, (List)list, (List)body);\n             }\n             case 40: {\n-                final int number = (int)this.readNumber(stream);\n-                stream.read();\n-                return (NewAttributeBands.LayoutElement)new NewAttributeBands.Call(this, number);\n+                final int intValue = (int)this.readNumber(stringReader);\n+                stringReader.read();\n+                return (NewAttributeBands.LayoutElement)new NewAttributeBands.Call(this, intValue);\n             }\n             case 75:\n             case 82: {\n-                final StringBuilder string = new StringBuilder(\"\").append((char)nextChar).append((char)stream.read());\n-                final char nxt = (char)stream.read();\n-                string.append(nxt);\n-                if (nxt == 'N') {\n-                    string.append((char)stream.read());\n+                final StringBuilder append = new StringBuilder(\"\").append((char)read).append((char)stringReader.read());\n+                final char c2 = (char)stringReader.read();\n+                append.append(c2);\n+                if (c2 == 'N') {\n+                    append.append((char)stringReader.read());\n                 }\n-                return (NewAttributeBands.LayoutElement)new NewAttributeBands.Reference(this, string.toString());\n+                return (NewAttributeBands.LayoutElement)new NewAttributeBands.Reference(this, append.toString());\n             }\n             default: {\n                 return null;\n             }\n         }\n     }\n     \n-    private NewAttributeBands.UnionCase readNextUnionCase(final StringReader stream) throws IOException {\n-        stream.mark(2);\n-        stream.read();\n-        final int next = stream.read();\n-        char ch = (char)next;\n-        if (ch == ')' || next == -1) {\n-            stream.reset();\n+    private NewAttributeBands.UnionCase readNextUnionCase(final StringReader stringReader) throws IOException {\n+        stringReader.mark(2);\n+        stringReader.read();\n+        final int read = stringReader.read();\n+        if ((char)read == ')' || read == -1) {\n+            stringReader.reset();\n             return null;\n         }\n-        stream.reset();\n-        stream.read();\n-        final List<Integer> tags = new ArrayList<Integer>();\n-        Integer nextTag;\n+        stringReader.reset();\n+        stringReader.read();\n+        final ArrayList list = new ArrayList();\n+        Integer number;\n         do {\n-            nextTag = this.readNumber(stream);\n-            if (nextTag != null) {\n-                tags.add(nextTag);\n-                stream.read();\n-            }\n-        } while (nextTag != null);\n-        stream.read();\n-        stream.mark(1);\n-        ch = (char)stream.read();\n-        if (ch == ']') {\n-            return new NewAttributeBands.UnionCase(this, (List)tags);\n-        }\n-        stream.reset();\n-        return new NewAttributeBands.UnionCase(this, (List)tags, (List)this.readBody(this.getStreamUpToMatchingBracket(stream)));\n-    }\n-    \n-    private Integer readNumber(final StringReader stream) throws IOException {\n-        stream.mark(1);\n-        final char first = (char)stream.read();\n-        final boolean negative = first == '-';\n-        if (!negative) {\n-            stream.reset();\n-        }\n-        stream.mark(100);\n-        int length = 0;\n-        int i;\n-        while ((i = stream.read()) != -1 && Character.isDigit((char)i)) {\n-            ++length;\n+            number = this.readNumber(stringReader);\n+            if (number != null) {\n+                list.add(number);\n+                stringReader.read();\n+            }\n+        } while (number != null);\n+        stringReader.read();\n+        stringReader.mark(1);\n+        if ((char)stringReader.read() == ']') {\n+            return new NewAttributeBands.UnionCase(this, (List)list);\n+        }\n+        stringReader.reset();\n+        return new NewAttributeBands.UnionCase(this, (List)list, (List)this.readBody(this.getStreamUpToMatchingBracket(stringReader)));\n+    }\n+    \n+    private Integer readNumber(final StringReader stringReader) throws IOException {\n+        stringReader.mark(1);\n+        final boolean b = (char)stringReader.read() == '-';\n+        if (!b) {\n+            stringReader.reset();\n+        }\n+        stringReader.mark(100);\n+        int n = 0;\n+        int read;\n+        while ((read = stringReader.read()) != -1 && Character.isDigit((char)read)) {\n+            ++n;\n         }\n-        stream.reset();\n-        if (length == 0) {\n+        stringReader.reset();\n+        if (n == 0) {\n             return null;\n         }\n-        final char[] digits = new char[length];\n-        final int read = stream.read(digits);\n-        if (read != digits.length) {\n+        final char[] array = new char[n];\n+        if (stringReader.read(array) != array.length) {\n             throw new IOException(\"Error reading from the input stream\");\n         }\n-        return Integer.valueOf(Integer.parseInt((negative ? \"-\" : \"\") + new String(digits)));\n+        return Integer.valueOf(Integer.parseInt((b ? \"-\" : \"\") + new String(array)));\n     }\n     \n-    private String readUpToMatchingBracket(final StringReader stream) throws IOException {\n+    private String readUpToMatchingBracket(final StringReader stringReader) throws IOException {\n         final StringBuilder sb = new StringBuilder();\n-        int foundBracket = -1;\n-        while (foundBracket != 0) {\n-            final int read = stream.read();\n+        int i = -1;\n+        while (i != 0) {\n+            final int read = stringReader.read();\n             if (read == -1) {\n                 break;\n             }\n             final char c = (char)read;\n             if (c == ']') {\n-                ++foundBracket;\n+                ++i;\n             }\n             if (c == '[') {\n-                --foundBracket;\n+                --i;\n             }\n-            if (foundBracket == 0) {\n+            if (i == 0) {\n                 continue;\n             }\n             sb.append(c);\n         }\n         return sb.toString();\n     }\n     \n     private void resolveCalls() {\n-        int backwardsCalls = 0;\n+        int backwardsCallCount = 0;\n         for (int i = 0; i < this.attributeLayoutElements.size(); ++i) {\n-            final NewAttributeBands.AttributeLayoutElement element = (NewAttributeBands.AttributeLayoutElement)this.attributeLayoutElements.get(i);\n-            if (element instanceof NewAttributeBands.Callable) {\n-                final NewAttributeBands.Callable callable = (NewAttributeBands.Callable)element;\n+            final NewAttributeBands.AttributeLayoutElement attributeLayoutElement = (NewAttributeBands.AttributeLayoutElement)this.attributeLayoutElements.get(i);\n+            if (attributeLayoutElement instanceof NewAttributeBands.Callable) {\n+                final NewAttributeBands.Callable callable = (NewAttributeBands.Callable)attributeLayoutElement;\n                 if (i == 0) {\n                     callable.setFirstCallable(true);\n                 }\n-                for (final NewAttributeBands.LayoutElement layoutElement : NewAttributeBands.Callable.access$400(callable)) {\n-                    backwardsCalls += this.resolveCallsForElement(i, callable, layoutElement);\n+                final Iterator iterator = NewAttributeBands.Callable.access$400(callable).iterator();\n+                while (iterator.hasNext()) {\n+                    backwardsCallCount += this.resolveCallsForElement(i, callable, (NewAttributeBands.LayoutElement)iterator.next());\n                 }\n             }\n         }\n-        this.backwardsCallCount = backwardsCalls;\n+        this.backwardsCallCount = backwardsCallCount;\n     }\n     \n-    private int resolveCallsForElement(final int i, final NewAttributeBands.Callable currentCallable, final NewAttributeBands.LayoutElement layoutElement) {\n-        int backwardsCalls = 0;\n+    private int resolveCallsForElement(final int n, final NewAttributeBands.Callable callable, final NewAttributeBands.LayoutElement layoutElement) {\n+        int n2 = 0;\n         if (layoutElement instanceof NewAttributeBands.Call) {\n             final NewAttributeBands.Call call = (NewAttributeBands.Call)layoutElement;\n-            int index = NewAttributeBands.Call.access$500(call);\n-            if (index == 0) {\n-                ++backwardsCalls;\n-                call.setCallable(currentCallable);\n-            }\n-            else if (index > 0) {\n-                for (int k = i + 1; k < this.attributeLayoutElements.size(); ++k) {\n-                    final NewAttributeBands.AttributeLayoutElement el = (NewAttributeBands.AttributeLayoutElement)this.attributeLayoutElements.get(k);\n-                    if (el instanceof NewAttributeBands.Callable && --index == 0) {\n-                        call.setCallable((NewAttributeBands.Callable)el);\n+            int access$500 = NewAttributeBands.Call.access$500(call);\n+            if (access$500 == 0) {\n+                ++n2;\n+                call.setCallable(callable);\n+            }\n+            else if (access$500 > 0) {\n+                for (int i = n + 1; i < this.attributeLayoutElements.size(); ++i) {\n+                    final NewAttributeBands.AttributeLayoutElement attributeLayoutElement = (NewAttributeBands.AttributeLayoutElement)this.attributeLayoutElements.get(i);\n+                    if (attributeLayoutElement instanceof NewAttributeBands.Callable && --access$500 == 0) {\n+                        call.setCallable((NewAttributeBands.Callable)attributeLayoutElement);\n                         break;\n                     }\n                 }\n             }\n             else {\n-                ++backwardsCalls;\n-                for (int k = i - 1; k >= 0; --k) {\n-                    final NewAttributeBands.AttributeLayoutElement el = (NewAttributeBands.AttributeLayoutElement)this.attributeLayoutElements.get(k);\n-                    if (el instanceof NewAttributeBands.Callable && ++index == 0) {\n-                        call.setCallable((NewAttributeBands.Callable)el);\n+                ++n2;\n+                for (int j = n - 1; j >= 0; --j) {\n+                    final NewAttributeBands.AttributeLayoutElement attributeLayoutElement2 = (NewAttributeBands.AttributeLayoutElement)this.attributeLayoutElements.get(j);\n+                    if (attributeLayoutElement2 instanceof NewAttributeBands.Callable && ++access$500 == 0) {\n+                        call.setCallable((NewAttributeBands.Callable)attributeLayoutElement2);\n                         break;\n                     }\n                 }\n             }\n         }\n         else if (layoutElement instanceof NewAttributeBands.Replication) {\n-            final List<NewAttributeBands.LayoutElement> children = NewAttributeBands.Replication.access$600((NewAttributeBands.Replication)layoutElement);\n-            for (final NewAttributeBands.LayoutElement child : children) {\n-                backwardsCalls += this.resolveCallsForElement(i, currentCallable, child);\n+            final Iterator iterator = NewAttributeBands.Replication.access$600((NewAttributeBands.Replication)layoutElement).iterator();\n+            while (iterator.hasNext()) {\n+                n2 += this.resolveCallsForElement(n, callable, (NewAttributeBands.LayoutElement)iterator.next());\n             }\n         }\n-        return backwardsCalls;\n+        return n2;\n     }\n     \n-    public void setBackwardsCalls(final int[] backwardsCalls) throws IOException {\n-        int index = 0;\n+    public void setBackwardsCalls(final int[] array) throws IOException {\n+        int n = 0;\n         this.parseLayout();\n-        for (final NewAttributeBands.AttributeLayoutElement element : this.attributeLayoutElements) {\n-            if (element instanceof NewAttributeBands.Callable && ((NewAttributeBands.Callable)element).isBackwardsCallable()) {\n-                ((NewAttributeBands.Callable)element).addCount(backwardsCalls[index]);\n-                ++index;\n+        for (final NewAttributeBands.AttributeLayoutElement attributeLayoutElement : this.attributeLayoutElements) {\n+            if (attributeLayoutElement instanceof NewAttributeBands.Callable && ((NewAttributeBands.Callable)attributeLayoutElement).isBackwardsCallable()) {\n+                ((NewAttributeBands.Callable)attributeLayoutElement).addCount(array[n]);\n+                ++n;\n             }\n         }\n     }\n     \n     public void unpack() throws IOException, Pack200Exception {\n     }\n }\n"}]}
