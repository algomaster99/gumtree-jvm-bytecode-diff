{"diffoscope-json-version": 1, "source1": "first/Class2HTML.class", "source2": "second/Class2HTML.class", "unified_diff": null, "details": [{"source1": "procyon -ec {}", "source2": "procyon -ec {}", "unified_diff": "@@ -27,140 +27,131 @@\n     \n     public Class2HTML(final JavaClass java_class, final String dir) throws IOException {\n         final Method[] methods = java_class.getMethods();\n         this.java_class = java_class;\n         this.dir = dir;\n         Class2HTML.class_name = java_class.getClassName();\n         Class2HTML.constant_pool = java_class.getConstantPool();\n-        final int index = Class2HTML.class_name.lastIndexOf(46);\n-        if (index > -1) {\n-            Class2HTML.class_package = Class2HTML.class_name.substring(0, index);\n+        final int lastIndex = Class2HTML.class_name.lastIndexOf(46);\n+        if (lastIndex > -1) {\n+            Class2HTML.class_package = Class2HTML.class_name.substring(0, lastIndex);\n         }\n         else {\n             Class2HTML.class_package = \"\";\n         }\n-        final ConstantHTML constant_html = new ConstantHTML(dir, Class2HTML.class_name, Class2HTML.class_package, methods, Class2HTML.constant_pool);\n-        final AttributeHTML attribute_html = new AttributeHTML(dir, Class2HTML.class_name, Class2HTML.constant_pool, constant_html);\n-        new MethodHTML(dir, Class2HTML.class_name, methods, java_class.getFields(), constant_html, attribute_html);\n-        this.writeMainHTML(attribute_html);\n-        new CodeHTML(dir, Class2HTML.class_name, methods, Class2HTML.constant_pool, constant_html);\n-        attribute_html.close();\n-    }\n-    \n-    public static void main(final String[] argv) throws IOException {\n-        final String[] file_name = new String[argv.length];\n-        int files = 0;\n-        ClassParser parser = null;\n-        JavaClass java_class = null;\n-        String zip_file = null;\n-        final char sep = File.separatorChar;\n-        String dir = \".\" + sep;\n-        for (int i = 0; i < argv.length; ++i) {\n-            if (argv[i].charAt(0) == '-') {\n-                if (argv[i].equals(\"-d\")) {\n-                    dir = argv[++i];\n-                    if (!dir.endsWith(\"\" + sep)) {\n-                        dir += sep;\n+        final ConstantHTML constantHTML = new ConstantHTML(dir, Class2HTML.class_name, Class2HTML.class_package, methods, Class2HTML.constant_pool);\n+        final AttributeHTML attributeHTML = new AttributeHTML(dir, Class2HTML.class_name, Class2HTML.constant_pool, constantHTML);\n+        new MethodHTML(dir, Class2HTML.class_name, methods, java_class.getFields(), constantHTML, attributeHTML);\n+        this.writeMainHTML(attributeHTML);\n+        new CodeHTML(dir, Class2HTML.class_name, methods, Class2HTML.constant_pool, constantHTML);\n+        attributeHTML.close();\n+    }\n+    \n+    public static void main(final String[] array) throws IOException {\n+        final String[] array2 = new String[array.length];\n+        int n = 0;\n+        String s = null;\n+        final char separatorChar = File.separatorChar;\n+        String str = \".\" + separatorChar;\n+        for (int i = 0; i < array.length; ++i) {\n+            if (array[i].charAt(0) == '-') {\n+                if (array[i].equals(\"-d\")) {\n+                    str = array[++i];\n+                    if (!str.endsWith(\"\" + separatorChar)) {\n+                        str += separatorChar;\n                     }\n-                    final File store = new File(dir);\n-                    if (!store.isDirectory()) {\n-                        final boolean created = store.mkdirs();\n-                        if (!created && !store.isDirectory()) {\n-                            System.out.println(\"Tried to create the directory \" + dir + \" but failed\");\n-                        }\n+                    final File file = new File(str);\n+                    if (!file.isDirectory() && !file.mkdirs() && !file.isDirectory()) {\n+                        System.out.println(\"Tried to create the directory \" + str + \" but failed\");\n                     }\n                 }\n-                else if (argv[i].equals(\"-zip\")) {\n-                    zip_file = argv[++i];\n+                else if (array[i].equals(\"-zip\")) {\n+                    s = array[++i];\n                 }\n                 else {\n-                    System.out.println(\"Unknown option \" + argv[i]);\n+                    System.out.println(\"Unknown option \" + array[i]);\n                 }\n             }\n             else {\n-                file_name[files++] = argv[i];\n+                array2[n++] = array[i];\n             }\n         }\n-        if (files == 0) {\n+        if (n == 0) {\n             System.err.println(\"Class2HTML: No input files specified.\");\n         }\n         else {\n-            for (int i = 0; i < files; ++i) {\n-                System.out.print(\"Processing \" + file_name[i] + \"...\");\n-                if (zip_file == null) {\n-                    parser = new ClassParser(file_name[i]);\n+            for (int j = 0; j < n; ++j) {\n+                System.out.print(\"Processing \" + array2[j] + \"...\");\n+                ClassParser classParser;\n+                if (s == null) {\n+                    classParser = new ClassParser(array2[j]);\n                 }\n                 else {\n-                    parser = new ClassParser(zip_file, file_name[i]);\n+                    classParser = new ClassParser(s, array2[j]);\n                 }\n-                java_class = parser.parse();\n-                new Class2HTML(java_class, dir);\n+                new Class2HTML(classParser.parse(), str);\n                 System.out.println(\"Done.\");\n             }\n         }\n     }\n     \n-    static String referenceClass(final int index) {\n-        String str = Class2HTML.constant_pool.getConstantString(index, (byte)7);\n-        str = Utility.compactClassName(str);\n-        str = Utility.compactClassName(str, Class2HTML.class_package + \".\", true);\n-        return \"<A HREF=\\\"\" + Class2HTML.class_name + \"_cp.html#cp\" + index + \"\\\" TARGET=ConstantPool>\" + str + \"</A>\";\n+    static String referenceClass(final int i) {\n+        return \"<A HREF=\\\"\" + Class2HTML.class_name + \"_cp.html#cp\" + i + \"\\\" TARGET=ConstantPool>\" + Utility.compactClassName(Utility.compactClassName(Class2HTML.constant_pool.getConstantString(i, (byte)7)), Class2HTML.class_package + \".\", true) + \"</A>\";\n     }\n     \n-    static String referenceType(final String type) {\n-        String short_type = Utility.compactClassName(type);\n-        short_type = Utility.compactClassName(short_type, Class2HTML.class_package + \".\", true);\n-        final int index = type.indexOf(91);\n-        String base_type = type;\n+    static String referenceType(final String str) {\n+        final String compactClassName = Utility.compactClassName(Utility.compactClassName(str), Class2HTML.class_package + \".\", true);\n+        final int index = str.indexOf(91);\n+        String substring = str;\n         if (index > -1) {\n-            base_type = type.substring(0, index);\n+            substring = str.substring(0, index);\n         }\n-        if (Class2HTML.basic_types.contains(base_type)) {\n-            return \"<FONT COLOR=\\\"#00FF00\\\">\" + type + \"</FONT>\";\n+        if (Class2HTML.basic_types.contains(substring)) {\n+            return \"<FONT COLOR=\\\"#00FF00\\\">\" + str + \"</FONT>\";\n         }\n-        return \"<A HREF=\\\"\" + base_type + \".html\\\" TARGET=_top>\" + short_type + \"</A>\";\n+        return \"<A HREF=\\\"\" + substring + \".html\\\" TARGET=_top>\" + compactClassName + \"</A>\";\n     }\n     \n-    static String toHTML(final String str) {\n-        final StringBuilder buf = new StringBuilder();\n-        for (int i = 0; i < str.length(); ++i) {\n-            final char ch;\n-            switch (ch = str.charAt(i)) {\n+    static String toHTML(final String s) {\n+        final StringBuilder sb = new StringBuilder();\n+        for (int i = 0; i < s.length(); ++i) {\n+            final char char1;\n+            switch (char1 = s.charAt(i)) {\n                 case '<': {\n-                    buf.append(\"&lt;\");\n+                    sb.append(\"&lt;\");\n                     break;\n                 }\n                 case '>': {\n-                    buf.append(\"&gt;\");\n+                    sb.append(\"&gt;\");\n                     break;\n                 }\n                 case '\\n': {\n-                    buf.append(\"\\\\n\");\n+                    sb.append(\"\\\\n\");\n                     break;\n                 }\n                 case '\\r': {\n-                    buf.append(\"\\\\r\");\n+                    sb.append(\"\\\\r\");\n                     break;\n                 }\n                 default: {\n-                    buf.append(ch);\n+                    sb.append(char1);\n                     break;\n                 }\n             }\n         }\n-        return buf.toString();\n+        return sb.toString();\n     }\n     \n-    private void writeMainHTML(final AttributeHTML attribute_html) throws IOException {\n-        try (final PrintWriter file = new PrintWriter(new FileOutputStream(this.dir + Class2HTML.class_name + \".html\"))) {\n-            file.println(\"<HTML>\\n<HEAD><TITLE>Documentation for \" + Class2HTML.class_name + \"</TITLE></HEAD>\\n<FRAMESET BORDER=1 cols=\\\"30%,*\\\">\\n<FRAMESET BORDER=1 rows=\\\"80%,*\\\">\\n<FRAME NAME=\\\"ConstantPool\\\" SRC=\\\"\" + Class2HTML.class_name + \"_cp.html\\\"\\n MARGINWIDTH=\\\"0\\\" MARGINHEIGHT=\\\"0\\\" FRAMEBORDER=\\\"1\\\" SCROLLING=\\\"AUTO\\\">\\n<FRAME NAME=\\\"Attributes\\\" SRC=\\\"\" + Class2HTML.class_name + \"_attributes.html\\\"\\n MARGINWIDTH=\\\"0\\\" MARGINHEIGHT=\\\"0\\\" FRAMEBORDER=\\\"1\\\" SCROLLING=\\\"AUTO\\\">\\n</FRAMESET>\\n<FRAMESET BORDER=1 rows=\\\"80%,*\\\">\\n<FRAME NAME=\\\"Code\\\" SRC=\\\"\" + Class2HTML.class_name + \"_code.html\\\"\\n MARGINWIDTH=0 MARGINHEIGHT=0 FRAMEBORDER=1 SCROLLING=\\\"AUTO\\\">\\n<FRAME NAME=\\\"Methods\\\" SRC=\\\"\" + Class2HTML.class_name + \"_methods.html\\\"\\n MARGINWIDTH=0 MARGINHEIGHT=0 FRAMEBORDER=1 SCROLLING=\\\"AUTO\\\">\\n</FRAMESET></FRAMESET></HTML>\");\n+    private void writeMainHTML(final AttributeHTML attributeHTML) throws IOException {\n+        try (final PrintWriter printWriter = new PrintWriter(new FileOutputStream(this.dir + Class2HTML.class_name + \".html\"))) {\n+            printWriter.println(\"<HTML>\\n<HEAD><TITLE>Documentation for \" + Class2HTML.class_name + \"</TITLE></HEAD>\\n<FRAMESET BORDER=1 cols=\\\"30%,*\\\">\\n<FRAMESET BORDER=1 rows=\\\"80%,*\\\">\\n<FRAME NAME=\\\"ConstantPool\\\" SRC=\\\"\" + Class2HTML.class_name + \"_cp.html\\\"\\n MARGINWIDTH=\\\"0\\\" MARGINHEIGHT=\\\"0\\\" FRAMEBORDER=\\\"1\\\" SCROLLING=\\\"AUTO\\\">\\n<FRAME NAME=\\\"Attributes\\\" SRC=\\\"\" + Class2HTML.class_name + \"_attributes.html\\\"\\n MARGINWIDTH=\\\"0\\\" MARGINHEIGHT=\\\"0\\\" FRAMEBORDER=\\\"1\\\" SCROLLING=\\\"AUTO\\\">\\n</FRAMESET>\\n<FRAMESET BORDER=1 rows=\\\"80%,*\\\">\\n<FRAME NAME=\\\"Code\\\" SRC=\\\"\" + Class2HTML.class_name + \"_code.html\\\"\\n MARGINWIDTH=0 MARGINHEIGHT=0 FRAMEBORDER=1 SCROLLING=\\\"AUTO\\\">\\n<FRAME NAME=\\\"Methods\\\" SRC=\\\"\" + Class2HTML.class_name + \"_methods.html\\\"\\n MARGINWIDTH=0 MARGINHEIGHT=0 FRAMEBORDER=1 SCROLLING=\\\"AUTO\\\">\\n</FRAMESET></FRAMESET></HTML>\");\n         }\n         final Attribute[] attributes = this.java_class.getAttributes();\n         for (int i = 0; i < attributes.length; ++i) {\n-            attribute_html.writeAttribute(attributes[i], \"class\" + i);\n+            attributeHTML.writeAttribute(attributes[i], \"class\" + i);\n         }\n     }\n     \n     static {\n         (basic_types = new HashSet<String>()).add(\"int\");\n         Class2HTML.basic_types.add(\"short\");\n         Class2HTML.basic_types.add(\"boolean\");\n"}]}
